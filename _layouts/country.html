---
---
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>{{ page.name }} – Atlas</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="{{ '/assets/css/country.css' | relative_url }}">
</head>
<body>

<main class="country-page">

    <a href="{{ '/' | relative_url }}" class="back-to-atlas">
        ← Back to atlas
    </a>

    <header class="country-header">
        <img
                src="{{ '/assets/flags/' | relative_url }}{{ page.iso2 | default: 'xx' | downcase }}.svg"
                alt="{{ page.name }} flag"
                class="country-flag"
                onerror="this.style.display='none'">

        <div>
            <h1>{{ page.name }}</h1>
            {% if page.continent %}
            <div class="continent">{{ page.continent }}</div>
            {% endif %}
        </div>
    </header>

    <div class="country-layout">

        <aside class="country-sidebar">

            {% if page.language and page.language.size > 0 %}
            <div class="fact">
                <label>Language</label>
                <div class="value">{{ page.language | join: ", " }}</div>
            </div>
            {% endif %}

            {% if page.capital %}
            <div class="fact">
                <label>Capital</label>
                <div class="value">{{ page.capital }}</div>
            </div>
            {% endif %}

            {% if page.best_months %}
            <div class="fact">
                <label>Best months to visit</label>
                <ul>
                    {% assign month_names = "January,February,March,April,May,June,July,August,September,October,November,December" | split: "," %}
                    {% for m in page.best_months %}
                    {% assign idx = m | plus: 0 | minus: 1 %}
                    <li>{{ month_names[idx] }}</li>
                    {% endfor %}
                </ul>
            </div>
            {% endif %}

            {% if page.ok_months %}
            <div class="fact">
                <label>Okay months</label>
                <ul>
                    {% assign month_names = "January,February,March,April,May,June,July,August,September,October,November,December" | split: "," %}
                    {% for m in page.ok_months %}
                    {% assign idx = m | plus: 0 | minus: 1 %}
                    <li>{{ month_names[idx] }}</li>
                    {% endfor %}
                </ul>
            </div>
            {% endif %}

            {% if page.budget and (page.budget.dkk or page.budget.eur) %}
            <div class="fact">
                <label>Budget per person for 7 days</label>
                {% if page.budget.dkk %}
                <div class="value">{{ page.budget.dkk }} DKK</div>
                {% endif %}
                {% if page.budget.eur %}
                <div class="budget-secondary">{{ page.budget.eur }} EUR</div>
                {% endif %}
            </div>
            {% endif %}

            {% if page.currency and page.currency.rates %}
            <div class="fact">
                <label>Currency</label>

                <div class="value">
                    {{ page.currency.name }}
                    <span class="currency-meta">
                        {{ page.currency.symbol }} ({{ page.currency.code }})
                    </span>
                </div>

                <div class="budget-secondary" style="margin-top:0.4rem;">
                    1 {{ page.currency.name }} =<br>
                    {{ page.currency.rates.per_1.eur }} EUR<br>
                    {{ page.currency.rates.per_1.dkk }} DKK
                </div>

                <div class="budget-secondary" style="margin-top:0.6rem;">
                    100 {{ page.currency.name }} =<br>
                    {{ page.currency.rates.per_100.eur }} EUR<br>
                    {{ page.currency.rates.per_100.dkk }} DKK
                </div>
            </div>
            {% endif %}

            {% if page.gay_friendliness %}
            <div class="fact">
                <label>Gay equality</label>

                <div class="gay-bar">
                    <div
                            class="gay-fill"
                            style="
                            width: {{ page.gay_friendliness }}%;
                            background: hsl({{ page.gay_friendliness | times: 1.2 }}, 70%, 45%);
                        ">
                    </div>
                </div>

                <div class="gay-score">{{ page.gay_friendliness }}/100</div>

                {% if page.gay_details %}
                <details class="gay-details">
                    <summary>More details</summary>
                    <div class="gay-details-content">
                        {{ page.gay_details | markdownify }}
                    </div>
                </details>
                {% endif %}
            </div>
            {% endif %}

            {% if page.tags and page.tags.size > 0 %}
            <div class="fact">
                <label>Tags</label>

                {% assign tag_labels =
                "culture:Culture,
                food:Food,
                cheap:Budget friendly,
                expensive:Expensive,
                island:Island,
                beach:Beach,
                walkable:Walkable,
                short_trip:Short trip,
                long_trip:Long trip,
                friends_and_family:Friends/family live here,
                gay_friendly:Gay friendly,
                j_wants_to_go:Places J wants to visit asap,
                m_wants_to_go:Places M wants to visit asap,
                j_has_been:Places J has been,
                m_has_been:Places M has been"
                | split: "," %}

                <ul class="tags">
                    {% for tag in page.tags %}
                    {% assign label = tag %}
                    {% for pair in tag_labels %}
                    {% assign kv = pair | split: ":" %}
                    {% assign key = kv[0] | strip %}
                    {% assign value = kv[1] | strip %}
                    {% if key == tag %}
                    {% assign label = value %}
                    {% endif %}
                    {% endfor %}

                    <li>
                        <a
                                href="{{ '/?tag=' | relative_url }}{{ tag }}&view="
                                class="tag-chip"
                                data-tag-link
                        >
                            {{ label }}
                        </a>
                    </li>
                    {% endfor %}
                </ul>
            </div>
            {% endif %}

        </aside>

        <section class="country-content">
            {{ content }}
        </section>

    </div>

</main>

<!-- SCRIPT 1: find out where the user came from -->
<script>
    const params = new URLSearchParams(window.location.search);
    const fromView = params.get("from") || "map";
    document.documentElement.dataset.fromView = fromView;
</script>

<!-- SCRIPT 2: update tag links to respect that view -->
<script>
    const fromView = document.documentElement.dataset.fromView || "map";

    document.querySelectorAll("[data-tag-link]").forEach(link => {
        link.href += fromView;
    });
</script>

</body>
</html>
